/**
 * This allows you to open the devmenu at any time
 * 
 * Recommended way to use this is to set up an alias:
 * 
 *   `$ alias devmenu='run /scripts/exploit-devmenu.js`
 */

/**
 * @param {NS} ns
 */
export async function main(ns) {
    // getProps returns the properties of the children of the '__reactProps*'
    // value
    let getProps = (obj) => Object.entries(obj).find(entry => entry[0].startsWith("__reactProps"))[1].children.props;
    // hasPlayer checks if `player` is in the properties of the given object
    let hasPlayer = (obj) => {
        try {
            // Attempt to fetch the properties of `obj`, then get `.player`
            return getProps(obj).player ? true : false
        }catch(ex) {
            // `.player` wasn't a valid name in `obj`, or something else
            // errored; e.g. getProps(obj) returned null
            return false
        }
    }
    // Get all boxes in the document - use `eval("document")` to prevent RAM
    // cost
    let boxes = Array.from(eval("document").querySelectorAll("[class*=MuiBox-root]"))
    // Get the box which defines the player property
    let box = boxes.find(x => hasPlayer(x))
    if(box) {
        // If we found such a box, get the properties of it then use its
        // router to open the devmenu
        ns.tprintf("INFO className: '%s'", box.className)
        let props = getProps(box)
        props.router.toDevMenu()
    }
}